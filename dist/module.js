/*! For license information please see module.js.LICENSE.txt */
define(["react"],e=>(()=>{"use strict";var t={20:(e,t,r)=>{var s=r(959),i=Symbol.for("react.element"),a=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),n=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function o(e,t,r){var s,o={},u=null,c=null;for(s in void 0!==r&&(u=""+r),void 0!==t.key&&(u=""+t.key),void 0!==t.ref&&(c=t.ref),t)a.call(t,s)&&!l.hasOwnProperty(s)&&(o[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps)void 0===o[s]&&(o[s]=t[s]);return{$$typeof:i,type:e,key:u,ref:c,props:o,_owner:n.current}}t.jsx=o,t.jsxs=o},848:(e,t,r)=>{e.exports=r(20)},959:t=>{t.exports=e}},r={};function s(e){var i=r[e];if(void 0!==i)return i.exports;var a=r[e]={exports:{}};return t[e](a,a.exports,s),a.exports}s.d=(e,t)=>{for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};s.r(i),s.d(i,{ConfigEditor:()=>c,DataSource:()=>a,QueryEditor:()=>u,plugin:()=>d});class a{constructor(e){this.name=e.name,this.id=e.id,this.meta={id:"goshposh-metaqueries-react-datasource"}}query(e){return __awaiter(this,void 0,void 0,function*(){console.log("Do query",e);const t=[];for(const r of e.targets||[])if(!r.hide)try{const s=yield this.processTarget(r,e);s&&t.push(s)}catch(e){console.error("Query error for target:",r,e)}return{data:t}})}processTarget(e,t){return __awaiter(this,void 0,void 0,function*(){const t={refId:e.refId,fields:[{name:"time",type:"time",values:[]},{name:e.outputMetricName||"value",type:"number",values:[]}]},r=Date.now();for(let e=0;e<10;e++)t.fields[0].values.push(r-6e4*e),t.fields[1].values.push(100*Math.random());return t})}testDatasource(){return __awaiter(this,void 0,void 0,function*(){return{status:"success",message:"Meta Source is working correctly",title:"Success"}})}getTargets(){return Promise.resolve([{refId:"A"},{refId:"B"},{refId:"C"},{refId:"D"},{refId:"E"}])}}var n=s(848);s(959);const l=[{label:"TimeShift",value:"TimeShift"},{label:"MovingAverage",value:"MovingAverage"},{label:"Arithmetic",value:"Arithmetic"}],o=[{label:"seconds",value:"seconds"},{label:"minutes",value:"minutes"},{label:"hours",value:"hours"},{label:"days",value:"days"},{label:"weeks",value:"weeks"},{label:"months",value:"months"}];function u({query:e,onChange:t,onRunQuery:r}){const s=()=>{r()};return(0,n.jsxs)("div",{style:{padding:"10px"},children:[(0,n.jsxs)("div",{style:{marginBottom:"10px",display:"flex",gap:"10px"},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{children:"Type:"}),(0,n.jsx)("select",{value:e.queryType||"TimeShift",onChange:s=>{t(Object.assign(Object.assign({},e),{queryType:s.target.value})),r()},style:{marginLeft:"5px"},children:l.map(e=>(0,n.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{children:"Output Name:"}),(0,n.jsx)("input",{type:"text",value:e.outputMetricName||"",onChange:r=>{t(Object.assign(Object.assign({},e),{outputMetricName:r.target.value}))},onBlur:s,placeholder:"metric name",style:{marginLeft:"5px"}})]})]}),("MovingAverage"===e.queryType||"TimeShift"===e.queryType)&&(0,n.jsxs)("div",{style:{marginBottom:"10px",display:"flex",gap:"10px"},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{children:"Periods:"}),(0,n.jsx)("input",{type:"number",value:e.periods||7,onChange:r=>{t(Object.assign(Object.assign({},e),{periods:parseInt(r.target.value,10)||7}))},onBlur:s,placeholder:"7",style:{marginLeft:"5px",width:"80px"}})]}),"TimeShift"===e.queryType&&(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{children:"Unit:"}),(0,n.jsx)("select",{value:e.timeshiftUnit||"days",onChange:s=>{t(Object.assign(Object.assign({},e),{timeshiftUnit:s.target.value})),r()},style:{marginLeft:"5px"},children:o.map(e=>(0,n.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{children:"Query:"}),(0,n.jsx)("input",{type:"text",value:e.query||"",onChange:r=>{t(Object.assign(Object.assign({},e),{query:r.target.value}))},onBlur:s,placeholder:"A",style:{marginLeft:"5px",width:"60px"}})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{children:"Metric:"}),(0,n.jsx)("input",{type:"text",value:e.metric||"",onChange:r=>{t(Object.assign(Object.assign({},e),{metric:r.target.value}))},onBlur:s,placeholder:"metric name",style:{marginLeft:"5px"}})]})]}),"Arithmetic"===e.queryType&&(0,n.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,n.jsx)("label",{children:"Expression:"}),(0,n.jsx)("input",{type:"text",value:e.expression||"",onChange:r=>{t(Object.assign(Object.assign({},e),{expression:r.target.value}))},onBlur:s,placeholder:"A + B",style:{marginLeft:"5px",width:"300px"}})]})]})}function c({options:e,onOptionsChange:t}){var r;return(0,n.jsxs)("div",{style:{padding:"10px"},children:[(0,n.jsx)("h3",{children:"Meta Queries Configuration"}),(0,n.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,n.jsx)("p",{children:"This data source allows you to perform meta queries on data from other data sources:"}),(0,n.jsxs)("ul",{children:[(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:"TimeShift:"})," Shift data by a specified time interval"]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:"MovingAverage:"})," Calculate moving averages"]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:"Arithmetic:"})," Perform arithmetic operations between queries"]})]})]}),(0,n.jsxs)("div",{style:{marginTop:"20px"},children:[(0,n.jsxs)("label",{children:[(0,n.jsx)("input",{type:"checkbox",checked:(null===(r=e.jsonData)||void 0===r?void 0:r.debugMode)||!1,onChange:r=>{t(Object.assign(Object.assign({},e),{jsonData:Object.assign(Object.assign({},e.jsonData),{debugMode:r.target.checked})}))},style:{marginRight:"5px"}}),"Enable debug mode"]}),(0,n.jsx)("p",{style:{fontSize:"12px",color:"#666",marginTop:"5px"},children:"Debug mode will log additional information to browser console"})]})]})}const d={DataSource:a,QueryEditor:u,ConfigEditor:c};return i})());